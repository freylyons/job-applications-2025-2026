"use strict";$(function(){function t(t,i){this.$container=$(t),!this.$container.length||i&&i.cookie&&e(i.cookie.name)||(this.$container.data("modal",this),this.settings=$.extend({},this.defaults,i),this.$modal=this.$container.find(this.settings.modal),this.$closeButton=this.$container.find(this.settings.closeButton),this.$showButton=$(this.settings.showButton),this.$modal[0]&&(this.initialTopPosition=getComputedStyle(this.$modal[0]).top),this.previousFocus={},this.$focusableChildren={},this.init())}function i(t){var i="",e=t.path||"/";if(t.days){var o=new Date;o.setTime(o.getTime()+24*t.days*60*60*1e3),i="; expires="+o.toUTCString()}document.cookie=t.name+"="+(t.value||1)+i+"; path="+e}function e(t){for(var i=t+"=",e=document.cookie.split(";"),o=0;o<e.length;o++){var s=e[o].trim();if(0==s.indexOf(i))return s.slice(i.length)}return null}var o=['a[href]:visible:not([tabindex^="-"]):not([inert])','area[href]:visible:not([tabindex^="-"]):not([inert])',"input:visible:not([disabled]):not([inert])","select:visible:not([disabled]):not([inert])","textarea:visible:not([disabled]):not([inert])","button:visible:not([disabled]):not([inert])",'iframe:visible:not([tabindex^="-"]):not([inert])','audio:visible:not([tabindex^="-"]):not([inert])','video:visible:not([tabindex^="-"]):not([inert])','[contenteditable]:visible:not([tabindex^="-"]):not([inert])','[tabindex]:visible:not([tabindex^="-"]):not([inert])'];t.prototype.defaults={modal:"[data-modal]",closeButton:"[data-modal-hide]",showButton:"[data-modal-show]",delay:300,showOnClick:!0,showAutomatically:!1,cookie:!1,setCookieOnClose:!1,role:"dialog",focusModal:!1,onOpen:null},t.prototype.init=function(){this.$modal.attr("role",this.settings.role),this.settings.showOnClick?this.$showButton.on("click",this.open.bind(this)):this.settings.showAutomatically&&setTimeout(this.open.bind(this),this.settings.delay),this.$closeButton.on("click",this.close.bind(this))},t.prototype.open=function(){this.previousFocus=document.activeElement,this.$container.removeAttr("aria-hidden"),this.isOpen=!0,this.updateFocusableChildren(),this.settings.focusModal?this.setFocus(this.$modal[0]):this.setFocus(),this.$modal.on("keydown",function(t){"Escape"===t.key||"Esc"===t.key?this.close():this.trapFocus(t)}.bind(this)),$(window).on("resize",this.resizeModal.bind(this)),this.resizeModal(),!this.settings.setCookieOnClose&&this.settings.cookie&&i(this.settings.cookie),"function"==typeof this.settings.onOpen&&this.settings.onOpen.call(this)},t.prototype.close=function(){this.$container.attr("aria-hidden","true"),this.isOpen=!1,this.previousFocus&&this.setFocus(this.previousFocus),this.$modal.off("keydown"),$(window).off("resize",this.resizeModal),this.settings.setCookieOnClose&&this.settings.cookie&&i(this.settings.cookie),this.promise&&this.promise.reject(),"function"==typeof this.settings.onClose&&this.settings.onClose.call(this)},t.prototype.trapFocus=function(t){if("Tab"===t.key){var i=document.activeElement,e=this.$focusableChildren[this.$focusableChildren.length-1];t.shiftKey?i!==this.$focusableChildren[0]&&i!==this.$modal[0]||(t.preventDefault(),this.setFocus(e)):i===e&&(t.preventDefault(),this.setFocus())}},t.prototype.updateFocusableChildren=function(){this.$focusableChildren=this.$modal.find(o.join())},t.prototype.setFocus=function(t){t?t.focus():this.$focusableChildren.length&&this.$focusableChildren[0].focus()},t.prototype.update=function(t){this.updateFocusableChildren(),this.setFocus(t)},t.prototype.resizeModal=function(){if(this.$modal.length){var t=$(window);this.$modal.offset().top-t.scrollTop()+this.$modal.outerHeight()>=t.height()?this.$modal.css({top:t.scrollTop()+30+"px"}).addClass("modal__content--overflowing"):this.$modal.css({top:this.initialTopPosition}).removeClass("modal__content--overflowing")}},window.Modal=t});