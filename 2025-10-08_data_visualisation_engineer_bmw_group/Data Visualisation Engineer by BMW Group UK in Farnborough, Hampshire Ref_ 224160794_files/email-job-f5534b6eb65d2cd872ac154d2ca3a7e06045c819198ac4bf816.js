"use strict";$(function(){function e(e,a){var o={};o[e.attr("name")]=a,c.showErrors(o)}function a(){var a=$("#to_email"),l=$("#from_email");n=a.val(),r=l.val()||n,$.ajax({url:t,type:"POST",data:{from_address:r,to_address:n}}).done(function(t){t.success?o():t.error?"Invalid to address"==t.error||"Please enter a to address"==t.error?e(a,"Please enter a valid email address"):"Invalid from address"==t.error?e(l,"Please enter a valid email address or leave blank"):i(t.error):i("Something went wrong, please try again shortly.")}).fail(function(){i("There was a connection problem, please try again shortly.")})}function o(){$("[data-email-modal-page-success]").show(),$("#email-modal-page-form").hide(),$("[data-email-modal-page-success] .job-title").text(s),$("[data-email-modal-page-success] .recipient").text(n),m.update(m.$modal.find("[data-email-modal-page-success]")[0])}function i(e){$(".cvl-modal:visible").find(".modal-error-box").slideDown(200).find("p").text(e)}function l(){if(!$("#mobile-icons").is(":visible")){var e=$(".cvl-modal");if(e.length){var a=$(window);e.offset().top-a.scrollTop()+e.outerHeight()>=a.height()?e.css({position:"absolute",top:a.scrollTop()+4+"px"}).data("overflowing",!0):e.css({position:"fixed",top:"160px"}).data("overflowing",!1)}}}var t,r,s,n,d=$("[data-email-job]"),m=new Modal("#email-job-modal",{showOnClick:!1,focusModal:!0}),c=$("#email-job-form").validate({rules:{to_email:{required:!0,email:!0},from_email:{required:!1,email:!0}},messages:{to_email:"Please enter a valid email address",from_email:"Please enter a valid email address or leave blank"},errorPlacement:function(e,a){e.addClass("email-modal-input-error form__input-error").insertAfter(a)},submitHandler:function(){a()}}),f=1;d.on("click",function(e){e.preventDefault(),f||c.resetForm(),f=0;var a=$(this);t=/candidate\/saved-jobs/.test(location.pathname)?this.pathname:location.pathname+"/email",s=a.data("job-title"),$("[data-email-modal-job-title]").text(s),$("[data-email-modal-page-success]").hide(),$(".modal-error-box").hide(),$("#to_email").val(n||""),$("#from_email").val(r&&r!=n?r:""),$("#to_email,#from_email").each(function(){$(this).val()&&$(this).trigger("blur")}),$("#email-modal-page-form").show(),d.is("[data-email-job]")?($("#share-job-modal [data-modal-hide]").trigger("click"),setTimeout(function(){m.open()},200)):m.open()});var p=$("#mobile-icons").is(":visible");$(window).on("resize",function(){var e=$(".cvl-modal");$("#mobile-icons").is(":visible")?p||(p=!0,e.css({top:$(window).scrollTop()+30+"px",position:"absolute"})):(p=!1,l(),e.css({top:e.data("overflowing")?$(window).scrollTop()+4+"px":"160px",position:e.data("overflowing")?"absolute":"fixed"}))})});